$$ n_i=\prod p_{n_i}^{c_{n_i}} $$
$$ t_i=\sum c_{n_i} $$
$$ f_n=\max (t_i) $$
$$ t_i=-\infty $$
$$ f_n=\max (f_n,f_{n+1}) $$